; SipHash with key "1234567812345678"
; About 665 bytes
; Source code in sip_hash_func.c
; signature: uint64_t siphash24(uint8_t *src, size_t src_sz)
; 000000000000073a <siphash24>:
push   rbp
push   rbx
mov    r11,rsi
shl    r11,0x38
xor    ebx,ebx
movabs rbp,<<rval1>> ; 0x544e51505a564050 ; 0x544e51505a564050
sub    rsp,0x18
movabs r9,<<rval2>> ; 0x5c5844545a575d5c ; 0xc0814040a070d0c
movabs r8,<<rval3>> ; 0x4b585b5044405744 ; 0x4b585b5044405744
mov    QWORD PTR [rsp+0x8],rax
xor    eax,eax
movabs rax,<<rval4>> ; 0x4c5252574d475742 ; 0x1c0202071d170712
label_781:
add    r8,r9
rol    r9,0xd
mov    rdx,rsi
xor    r9,r8
sub    rdx,rbx
rol    r8,0x20
mov    rcx,r9
rol    rcx,0x11
cmp    rdx,0x7
jbe    label_80c ; <siphash24+0xd2>
mov    r10,QWORD PTR [rdi+rbx*1]
add    rbx,0x8
xor    rax,r10
add    rbp,rax
rol    rax,0x10
xor    rax,rbp
add    rbp,r9
mov    rdx,rax
add    r8,rax
xor    rcx,rbp
rol    rdx,0x15
rol    rbp,0x20
xor    rdx,r8
add    r8,rcx
rol    rcx,0xd
add    rbp,rdx
rol    rdx,0x10
xor    rcx,r8
xor    rdx,rbp
rol    r8,0x20
mov    r9,rcx
add    r8,rdx
rol    rdx,0x15
add    rbp,rcx
rol    r9,0x11
mov    rax,rdx
xor    r9,rbp
xor    rax,r8
rol    rbp,0x20
xor    r8,r10
jmp    label_781 ; <siphash24+0x47>
label_80c:
mov    r10,rsi
mov    QWORD PTR [rsp],0x0
shr    r10,0x3
imul   rdx,r10,0xfffffffffffffff8
add    rsi,rdx
lea    rdx,[rdi+r10*8]
cmp    rsi,0x7
jne    label_837 ; <siphash24+0xfd>
mov    sil,BYTE PTR [rdx+0x6]
mov    BYTE PTR [rsp+0x6],sil
jmp    label_83d ; <siphash24+0x103>
label_837:
cmp    rsi,0x6
jne    label_848 ; <siphash24+0x10e>
label_83d:
mov    sil,BYTE PTR [rdx+0x5]
mov    BYTE PTR [rsp+0x5],sil
jmp    label_84e ; <siphash24+0x114>
label_848:
cmp    rsi,0x5
jne    label_859 ; <siphash24+0x11f>
label_84e:
mov    sil,BYTE PTR [rdx+0x4]
mov    BYTE PTR [rsp+0x4],sil
jmp    label_85f ; <siphash24+0x125>
label_859:
cmp    rsi,0x4
jne    label_866 ; <siphash24+0x12c>
label_85f:
mov    esi,DWORD PTR [rdx]
mov    DWORD PTR [rsp],esi
jmp    label_86c ; <siphash24+0x132>
label_866:
cmp    rsi,0x3
jne    label_877 ; <siphash24+0x13d>
label_86c:
mov    sil,BYTE PTR [rdx+0x2]
mov    BYTE PTR [rsp+0x2],sil
jmp    label_87d ; <siphash24+0x143>
label_877:
cmp    rsi,0x2
jne    label_888 ; <siphash24+0x14e>
label_87d:
mov    sil,BYTE PTR [rdx+0x1]
mov    BYTE PTR [rsp+0x1],sil
jmp    label_88d ; <siphash24+0x153>
label_888:
dec    rsi
jne    label_892 ; <siphash24+0x158>
label_88d:
mov    dl,BYTE PTR [rdx]
mov    BYTE PTR [rsp],dl
label_892:
mov    rsi,QWORD PTR [rsp]
or     rsi,r11
xor    rax,rsi
lea    rdi,[rbp+rax*1+0x0]
rol    rax,0x10
xor    rax,rdi
mov    rdx,rax
lea    rax,[rdi+r9*1]
add    r8,rdx
rol    rdx,0x15
xor    rcx,rax
xor    rdx,r8
rol    rax,0x20
add    r8,rcx
add    rax,rdx
rol    rcx,0xd
rol    rdx,0x10
xor    rcx,r8
rol    r8,0x20
xor    rdx,rax
add    rax,rcx
rol    rcx,0x11
add    r8,rdx
xor    rcx,rax
rol    rdx,0x15
rol    rax,0x20
xor    rsi,r8
xor    rdx,r8
add    rsi,rcx
xor    al,0xff
rol    rcx,0xd
add    rax,rdx
xor    rcx,rsi
rol    rdx,0x10
xor    rdx,rax
rol    rsi,0x20
add    rax,rcx
rol    rcx,0x11
add    rsi,rdx
rol    rdx,0x15
xor    rcx,rax
xor    rdx,rsi
rol    rax,0x20
add    rsi,rcx
rol    rcx,0xd
add    rax,rdx
xor    rcx,rsi
rol    rdx,0x10
rol    rsi,0x20
xor    rdx,rax
add    rax,rcx
rol    rcx,0x11
add    rsi,rdx
xor    rcx,rax
rol    rdx,0x15
xor    rdx,rsi
rol    rax,0x20
add    rsi,rcx
rol    rcx,0xd
add    rax,rdx
rol    rdx,0x10
xor    rcx,rsi
xor    rdx,rax
rol    rsi,0x20
add    rax,rcx
rol    rcx,0x11
add    rsi,rdx
xor    rcx,rax
rol    rdx,0x15
rol    rax,0x20
xor    rdx,rsi
lea    rdi,[rsi+rcx*1]
rol    rcx,0xd
lea    rsi,[rdx+rax*1]
mov    rax,rdx
xor    rcx,rdi
rol    rax,0x10
lea    rdx,[rsi+rcx*1]
xor    rax,rsi
rol    rcx,0x11
rol    rax,0x15
xor    rcx,rdx
rol    rdx,0x20
xor    rax,rcx
xor    rax,rdx
add    rsp,0x18
pop    rbx
pop    rbp
ret
