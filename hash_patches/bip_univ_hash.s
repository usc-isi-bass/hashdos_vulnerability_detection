; static unsigned char __attribute__ ((noinline)) hash_func_patched(const char *pkey)
; {
;         char c;
;         int hash = 0x42021;
;         int r = 67601921;
;         while ((c = *pkey++)) {
;                 hash += (r * c);
;                 r ^= r << 13;
;                 r ^= r >> 17;
;                 r ^= r << 5;
;         }
;         return (unsigned char)hash;
; }
push rcx
push rdx
mov    ecx,0x4078601
mov    eax,0x42021
start:
inc    rdi
movsx  edx,BYTE PTR [rdi-0x1]
test   dl,dl
je     done
imul   edx,ecx
add    eax,edx
mov    edx,ecx
shl    edx,0xd
xor    edx,ecx
mov    ecx,edx
sar    ecx,0x11
xor    edx,ecx
mov    ecx,edx
shl    ecx,0x5
xor    ecx,edx
jmp    start
done:
pop rdx
pop rcx
ret
