;static unsigned char __attribute__ ((noinline)) hash_func_patched(const char *pkey)
;{
;        char c;
;        int hash = 0x42021;
;        int r = 67601921;
;        while ((c = *pkey++)) {
;                if (97 <= (int)c && (int)c <= 122) {
;                        c ^= 32;
;                }
;                hash += (r * c);
;                r ^= r << 13;
;                r ^= r >> 17;
;                r ^= r << 5;
;        }
;        return (unsigned char)hash;
;}
push rcx
push rdx
mov    ecx,0x4078601
mov    eax,0x42021
loop:
inc    rdi
mov    dl,BYTE PTR [rdi-0x1]
test   dl,dl
je     done
lea    esi,[rdx-0x61]
cmp    sil,0x19
ja     fi
xor    edx,0x20
fi:
movsx  edx,dl
imul   edx,ecx
add    eax,edx
mov    edx,ecx
shl    edx,0xd
xor    edx,ecx
mov    ecx,edx
sar    ecx,0x11
xor    edx,ecx
mov    ecx,edx
shl    ecx,0x5
xor    ecx,edx
jmp    loop
done:
pop rdx
pop rcx
ret
