;static unsigned char __attribute__ ((noinline)) hash_func_patched(const char *pkey)
;{
;        char c;
;        int hash = 0x42021;
;        int r = 67601921;
;        while ((c = *pkey++)) {
;                if (97 <= (int)c && (int)c <= 122) {
;                        c ^= 32;
;                }
;                hash += (r * c);
;                r ^= r << 13;
;                r ^= r >> 17;
;                r ^= r << 5;
;        }
;        return (unsigned char)hash;
;}
push %rcx
push %rdx
mov    $0x4078601,%ecx
mov    $0x42021,%eax
loop:
inc    %rdi
mov    -0x1(%rdi),%dl
test   %dl,%dl
je     done
lea    -0x61(%rdx),%esi
cmp    $0x19,%sil
ja     fi
xor    $0x20,%edx
fi:
movsbl %dl,%edx
imul   %ecx,%edx
add    %edx,%eax
mov    %ecx,%edx
shl    $0xd,%edx
xor    %ecx,%edx
mov    %edx,%ecx
sar    $0x11,%ecx
xor    %ecx,%edx
mov    %edx,%ecx
shl    $0x5,%ecx
xor    %edx,%ecx
jmp    loop
done:
pop %rcx
pop %rdx
retq
